<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Compact B/W Calendar</title>
  <style>
    :root{
      --bg:#f7f7f7;
      --card:#ffffff;
      --ink:#2e2e2e;
      --muted:#9b9b9b;
      --accent:#ececec;
      --radius:8px;
      --shadow:0 6px 14px rgba(46,46,46,0.04);
      --font: system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      display:flex;
      align-items:center;
      justify-content:center;
      padding:12px;
      background:var(--bg);
      font-family:var(--font);
      color:var(--ink);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .widget{
      width:100%;
      max-width:340px;
      background:var(--card);
      border-radius:var(--radius);
      padding:10px;
      box-shadow:var(--shadow);
      border:1px solid rgba(46,46,46,0.03);
    }

    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:8px;
    }

    .month{
      font-size:14px;
      font-weight:600;
      color:var(--ink);
    }

    .controls{display:flex;gap:6px;align-items:center}
    button.icon{
      background:transparent;
      border:1px solid var(--accent);
      color:var(--ink);
      padding:5px 6px;
      border-radius:6px;
      cursor:pointer;
      font-size:12px;
      line-height:1;
    }
    button.icon:active{transform:translateY(1px)}
    .today-btn{background:none;border:none;color:var(--muted);font-size:12px;cursor:pointer}

    .weekday-row{
      display:grid;
      grid-template-columns:repeat(7,1fr);
      gap:4px;
      margin-bottom:6px;
      color:var(--muted);
      font-size:11px;
      text-align:center;
    }

    .calendar-grid{
      display:grid;
      grid-template-columns:repeat(7,1fr);
      gap:6px;
    }

    .cell{
      min-height:44px;
      padding:6px;
      border-radius:6px;
      font-size:12px;
      color:var(--ink);
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      align-items:flex-start;
      background:transparent;
    }

    .cell.inactive{ color:rgba(46,46,46,0.36) }

    .date{
      width:26px;height:26px;border-radius:6px;
      display:inline-grid;place-items:center;
      font-weight:600;font-size:12px;color:var(--ink);
    }

    .cell.today{ background:linear-gradient(180deg, rgba(46,46,46,0.03), rgba(46,46,46,0.02)); border:1px solid rgba(46,46,46,0.03) }
    .date.today{ background:var(--ink); color:var(--card); width:28px;height:28px;font-size:12px }

    .event-dot{
      margin-top:6px;
      width:100%;
      height:6px;
      border-radius:6px;
      background:var(--accent);
      color:var(--muted);
      font-size:11px;
      display:flex;
      align-items:center;
      justify-content:left;
      padding-left:6px;
    }

    @media (max-width:340px){
      .widget{padding:8px}
      .cell{min-height:40px;padding:5px}
      .date{width:24px;height:24px}
      .date.today{width:26px;height:26px}
    }
  </style>
</head>
<body>
  <main class="widget" aria-label="Compact calendar widget">
    <div class="header">
      <div class="month" id="monthLabel">March 2025</div>
      <div class="controls">
        <button class="icon" id="prev" aria-label="Previous month">◀</button>
        <button class="icon" id="next" aria-label="Next month">▶</button>
        <button class="today-btn" id="todayBtn" aria-label="Today">Today</button>
      </div>
    </div>

    <div class="weekday-row" aria-hidden="true">
      <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
    </div>

    <div class="calendar-grid" id="grid" role="grid" aria-label="Calendar days"></div>
  </main>

  <script>
    (function(){
      const grid = document.getElementById('grid');
      const monthLabel = document.getElementById('monthLabel');
      const prev = document.getElementById('prev');
      const next = document.getElementById('next');
      const todayBtn = document.getElementById('todayBtn');

      let viewDate = new Date();
      viewDate.setDate(1);

      const events = {
        // Example: "2025-03-05":"Script",
      };

      function formatMonth(d){ return d.toLocaleString(undefined,{month:'short', year:'numeric'}); }
      function toISOYMD(d){
        const y=d.getFullYear();
        const m=String(d.getMonth()+1).padStart(2,'0');
        const day=String(d.getDate()).padStart(2,'0');
        return `${y}-${m}-${day}`;
      }

      function render(){
        grid.innerHTML='';
        monthLabel.textContent = formatMonth(viewDate);

        const year = viewDate.getFullYear();
        const month = viewDate.getMonth();
        const first = new Date(year, month, 1);
        const startDay = first.getDay();
        const daysInMonth = new Date(year, month+1, 0).getDate();
        const prevDays = new Date(year, month, 0).getDate();

        for(let i = startDay - 1; i >= 0; i--){
          const dateNum = prevDays - i;
          grid.appendChild(makeCell(new Date(year, month-1, dateNum), true));
        }
        for(let d=1; d<=daysInMonth; d++){
          grid.appendChild(makeCell(new Date(year, month, d), false));
        }
        while(grid.children.length % 7 !== 0){
          const dayCount = grid.children.length;
          const nextIndex = dayCount - startDay - daysInMonth + 1;
          grid.appendChild(makeCell(new Date(year, month+1, nextIndex), true));
        }
      }

      function makeCell(dateObj, inactive){
        const iso = toISOYMD(dateObj);
        const today = new Date();
        const isToday = iso === toISOYMD(today);

        const cell = document.createElement('div');
        cell.className = 'cell' + (inactive ? ' inactive' : '') + (isToday ? ' today' : '');
        cell.setAttribute('role','gridcell');
        cell.setAttribute('aria-label', dateObj.toDateString());

        const dateSpan = document.createElement('div');
        dateSpan.className = 'date' + (isToday ? ' today' : '');
        dateSpan.textContent = String(dateObj.getDate());
        cell.appendChild(dateSpan);

        if(events[iso]){
          const ev = document.createElement('div');
          ev.className = 'event-dot';
          ev.textContent = events[iso];
          cell.appendChild(ev);
        } else {
          const ph = document.createElement('div');
          ph.style.height='6px';
          ph.style.marginTop='6px';
          cell.appendChild(ph);
        }

        cell.addEventListener('click', () => {
          const msg = `${dateObj.toDateString()}${events[iso] ? ' — '+events[iso] : ''}`;
          showToast(msg);
        });

        return cell;
      }

      let toastTimer = null;
      function showToast(text){
        let t = document.getElementById('cw-toast');
        if(!t){
          t = document.createElement('div');
          t.id = 'cw-toast';
          Object.assign(t.style,{
            position:'fixed',
            left:'50%',
            transform:'translateX(-50%)',
            bottom:'20px',
            background:'rgba(46,46,46,0.06)',
            color: 'var(--ink)',
            border:'1px solid rgba(46,46,46,0.04)',
            padding:'6px 10px',
            borderRadius:'8px',
            fontSize:'12px',
            zIndex:9999
          });
          document.body.appendChild(t);
        }
        t.textContent = text;
        t.style.opacity = '1';
        if(toastTimer) clearTimeout(toastTimer);
        toastTimer = setTimeout(()=>{ t.style.opacity = '0'; }, 1800);
      }

      prev.addEventListener('click', ()=>{ viewDate.setMonth(viewDate.getMonth()-1); render(); });
      next.addEventListener('click', ()=>{ viewDate.setMonth(viewDate.getMonth()+1); render(); });
      todayBtn.addEventListener('click', ()=>{ viewDate = new Date(); viewDate.setDate(1); render(); });

      render();
    })();
  </script>
</body>
</html>
