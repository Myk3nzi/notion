<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mini B/W Calendar - Fixed</title>
<style>
  :root{
    --bg:#f8f8f8;
    --card:#fbfbfb;
    --ink:#3a3a3a;
    --muted:#a7a7a7;
    --accent:#ededed;
    --radius:6px;
    --font: system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    display:flex;align-items:center;justify-content:center;
    padding:6px;background:var(--bg);font-family:var(--font);color:var(--ink);
  }

  .widget{
    width:100%;max-width:220px;background:var(--card);border-radius:var(--radius);
    padding:6px;border:1px solid rgba(58,58,58,0.04);
  }

  .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  .month{font-size:12px;font-weight:600;color:var(--ink)}
  .controls{display:flex;gap:6px;align-items:center}
  button.icon{background:transparent;border:1px solid var(--accent);color:var(--ink);padding:4px 6px;border-radius:6px;font-size:11px;cursor:pointer}

  .weekday-row{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:4px;color:var(--muted);font-size:9px;text-align:center}

  .grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
  .cell{
    min-height:30px;padding:3px;border-radius:6px;font-size:11px;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;
    overflow:hidden; /* prevent content spill */
  }
  .cell.inactive{color:rgba(58,58,58,0.36)}

  /* Fixed-size date box prevents overflow */
  .date{
    width:18px;height:18px;border-radius:5px;display:inline-flex;align-items:center;justify-content:center;
    font-weight:600;font-size:10px;line-height:1;color:var(--ink);
    flex:0 0 18px; /* strictly fixed */
    overflow:hidden;white-space:nowrap;text-overflow:ellipsis;
  }

  .cell.today{background:linear-gradient(180deg, rgba(58,58,58,0.03), rgba(58,58,58,0.02));border:1px solid rgba(58,58,58,0.03)}
  .date.today{background:var(--ink);color:var(--card);width:20px;height:20px;font-size:10px;flex:0 0 20px}

  .event{margin-top:6px;height:6px;width:100%;border-radius:6px;background:var(--accent);opacity:0.95;font-size:9px;color:var(--muted);display:flex;align-items:center;padding-left:4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}

  /* Make sure the whole cell can't push outside */
  .cell > * { max-width:100%; box-sizing:border-box; }

  @media (max-width:220px){
    .widget{padding:5px}
    .cell{min-height:28px;padding:3px}
    .date{width:16px;height:16px;font-size:9px;flex:0 0 16px}
    .date.today{width:18px;height:18px}
  }
</style>
</head>
<body>
<main class="widget" aria-label="Mini calendar">
  <div class="header">
    <div class="month" id="monthLabel">Mar 2025</div>
    <div class="controls">
      <button class="icon" id="prev" aria-label="Prev">◀</button>
      <button class="icon" id="next" aria-label="Next">▶</button>
    </div>
  </div>

  <div class="weekday-row" aria-hidden="true">
    <div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div>
  </div>

  <div class="grid" id="grid" role="grid" aria-label="Days"></div>
</main>

<script>
(function(){
  const grid=document.getElementById('grid');
  const monthLabel=document.getElementById('monthLabel');
  const prev=document.getElementById('prev');
  const next=document.getElementById('next');
  let view=new Date(); view.setDate(1);

  const events = {
    // "2025-03-05":"Script",
  };

  function iso(d){return d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0')}
  function fm(d){return d.toLocaleString(undefined,{month:'short', year:'numeric'})}
  function render(){
    grid.innerHTML=''; monthLabel.textContent=fm(view);
    const y=view.getFullYear(), m=view.getMonth();
    const first=new Date(y,m,1), start=first.getDay();
    const days=new Date(y,m+1,0).getDate(), prevDays=new Date(y,m,0).getDate();
    for(let i=start-1;i>=0;i--){ grid.appendChild(cell(new Date(y,m-1,prevDays-i),true)); }
    for(let d=1;d<=days;d++){ grid.appendChild(cell(new Date(y,m,d),false)); }
    while(grid.children.length%7!==0){ const idx=grid.children.length-start-days+1; grid.appendChild(cell(new Date(y,m+1,idx),true)); }
  }

  function cell(dateObj,inactive){
    const today=new Date(), isToday=iso(dateObj)===iso(today);
    const el=document.createElement('div');
    el.className='cell'+(inactive?' inactive':'')+(isToday?' today':'');
    el.setAttribute('role','gridcell');
    const ds=document.createElement('div');
    ds.className='date'+(isToday?' today':'');
    ds.textContent=dateObj.getDate();
    el.appendChild(ds);
    if(events[iso(dateObj)]){ const e=document.createElement('div'); e.className='event'; e.textContent=events[iso(dateObj)]; el.appendChild(e); }
    return el;
  }

  prev.addEventListener('click',()=>{ view.setMonth(view.getMonth()-1); render(); });
  next.addEventListener('click',()=>{ view.setMonth(view.getMonth()+1); render(); });

  render();
})();
</script>
</body>
</html>
